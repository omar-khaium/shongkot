#!/usr/bin/env bash
# Pre-commit hook to ensure dart code is formatted

set -euo pipefail

echo "üîç Running Dart format check..."

cd mobile 2>/dev/null || {
  echo "‚ö†Ô∏è  Not in mobile directory, skipping format check"
  exit 0
}

if ! command -v dart &> /dev/null; then
  echo "‚ö†Ô∏è  Dart not found, skipping format check"
  exit 0
fi

if dart format --output=none --set-exit-if-changed .; then
  echo "‚úÖ Dart code is properly formatted"
  exit 0
else
  echo "‚ùå Dart code needs formatting!"
  echo ""
  echo "Please run:"
  echo "  cd mobile && dart format ."
  echo ""
  echo "Or to auto-format and retry:"
  echo "  cd mobile && dart format . && cd .. && git add -u && git commit --amend --no-edit"
  exit 1
fi
